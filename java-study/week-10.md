## 10주차 스터디
### 목표
자바의 멀티스레드 프로그래밍에 대해 학습하세요
### 학습할 것 (필수)
- Thread 클래스와 Runnable 인터페이스
- 쓰레드의 상태
- 쓰레드의 우선순위
- Main 쓰레드
- 동기화
- 데드락

# 1.스레드란?
스레드가 무엇인지 알기 전에는 프로그램과 프로세스, 스레드, 그리고 메모리 공간을 각각 알아야 합니다. 그 차이에 대해 먼저 알아보겠습니다. 

#### 프로그램이란?
프로그램이란, 어떤 작업을 위해 컴퓨터에게 주어진 처리방법과 순서가 기술된 일련의 명령문 집합체입니다. 쉽게 말해서 컴퓨터에서 어떤 작업을 위해 실행시킬 수 있는 **정적인 상태**의 실행 파일입니다. 프로그램은 컴퓨터의 보조 기억장치에 저장되어 있습니다.

#### 프로세스란?
프로세스란 프로그램이 실제 실행되고 있는 상태, 컴퓨터에서 연속적으로 실행되고 있는 **동적인 상태**의 프로그램입니다. 프로그램은 운영체제로부터 실행에 필요한 자원을 할당받아서 프로세스가 됩니다.

#### 스레드란?
프로세스가 할당받은 자원을 사용해서 실제 작업을 수행하는 주체가 스레드입니다. 사전적인 의미로 한 가닥의 실이라는 뜻인데, 한 가지 작업을 실행하기 위해 순차적으로 실행할 코드를 실처럼 이어놓았다고 해서 유래된 이름입니다. 모든 프로세스는 최소 1개 이상의 스레드로 구성되어 있으며, 두 개 이상의 스레드를 가지는 프로세스를 **멀티 스레드 프로세스**라고 부릅니다.

#### 멀티 스레딩의 장점
- CPU 사용률 향상
- 자원을 보다 효율적으로 사용 가능
- 클라이언트에 대한 응답성 향상
- 작업이 스레드별로 분리되어 코드가 간결해짐

멀티 스레딩은 위와 같은 장점을 갖고 있지만, 멀티 프로세스를 구성하는 하나의 프로세스에서 에러가 발생해도 다른 프로세스에 영향을 끼치지 않는 것과는 반대로, 멀티 스레드의 경우는 스레드가 하나의 프로세스 내부에 생기기 때문에 스레드가 예외를 발생시키면 전체 프로세스가 종료되어 다른 스레드에 영향을 미치게 됩니다.

**따라서 멀티 스레드에서는 예외 처리에 만전을 기해야 합니다.**

<img width="600" alt="스크린샷 2021-10-06 오후 11 19 48" src="https://user-images.githubusercontent.com/80696862/136221613-61f5597c-9c9e-4994-8ec8-9b16c2527465.png">

<img width="650" alt="스크린샷 2021-10-07 오후 1 43 01" src="https://user-images.githubusercontent.com/80696862/136321627-dd60a048-b2ef-49f5-83dc-7063631b6a17.png">


#### 스레드의 특징
- 각 스레드는 독자적인 Stack 메모리 영역을 갖는다
- 각 스레드는 프로세스 내에서 Heap, Static, Code 영역을 서로 공유한다
- 하지만 Stack과 레지스터는 스레드당 별도의 영역으로 할당받는다.

#### 프로세스의 메모리 공간

- **PC Register** 
    - 현재 스레드에서 다음에 실행해야 할 명령어의 위치(주소)를 보관하는 레지스터
    - 스레드마다 개별적으로 생성
- **Stack** :
    - 함수 호출시 생성되는 파라미터와 지역변수, 되돌아갈 주소값,메소드의 실행 정보를 담고 있는 스택 프레임 등을 저장하는 영역
    - 스택 메모리 영역은 스레드 개별로 할당
    - 이것은 독립적인 함수 호출이 가능하고 독립적인 실행 흐름이 가능하다는 뜻
    - 독립적인 실행 흐름을 위한 최소 조건으로 스레드별로 독립된 스택을 할당
- **Heap** :
    - 사용자가 직접 할당하고 해제하는 공간
    - Java의 경우 new를 통해 heap에 인스턴스가 생김
    - 더이상 인스턴스가 참조되지 않으면 gc에 의해 제거
- **Data** :
    - 프로그램이 시작할때 생성되고 종료시까지 유지되는 메모리 공간
    - Java의 경우 전역 변수
- **Code** : 
    - 실행할 프로그램의 코드가 저장되는 영역
    - Text 영역이라고도 부름
    - CPU는 이 영역에 저장된 명령을 하나씩 처리
    - 프로그램이 시작되고 종료시까지 메모리에 유지

### 1-2. 우리가 모르게 사용 중인 메인 스레드
모든 자바 애플리케이션은 메인 스레드가 메인 메소드를 실행하면서 시작됩니다.

```java
public class Calculator {

    public static void main(String[] args) {
        int result = sum(10, 40);
        System.out.println(result);
    }

    public static void sum(int a, int b) {
        int result = a + b;
        return result;
    }
}
```

# 2. 스레드를 생성하는 방법
자바에서는 스레드를 생성할 수 있는 방법이 두 가지가 있습니다.
- Thread 클래스 extends 하기
- Runnable 인터페이스 implements 하기

스레드를 생성하기 위한 두 가지 방법이 있지만, 어떤 방법이든 우리가 해야할 일은 run 메소드를 오버라이딩하는 것입니다.

## 2-1 Thread 클래스
```java
public class MyThread extends Thread {

    @Override
    public void run() {
        System.out.println("상속해서 정의한 스레드");
    }
}
```

## 2-2 Runnable 인터페이스

## 2-3. 생성한 스레드 실행하기

## 2-4 스레드 상속과 구현 중 선택하는 기준
- run 메소드 이외에 재정의할 메소드가 **있다** --> **상속**
- run 메소디 이외에 재정의할 메소드가 **없다** -- > **구현**



## 2-5. Thread 클래스의 메소드 종류

___

참고 : [자바의 정석 3판](http://www.yes24.com/Product/Goods/24259565?OzSrank=2), [이것이 자바다](http://www.yes24.com/Product/Goods/15651484?OzSrank=2), [쓰레드(Thread)란 무엇인가?](https://goodgid.github.io/What-is-Thread/), [Java JVM Run-time Data Areas](https://javapapers.com/core-java/java-jvm-run-time-data-areas/#Method_Area), [JVM Stacks and Stack Frames](https://alvinalexander.com/scala/fp-book/recursion-jvm-stacks-stack-frames/)
