## 1주차 과제 : JVM은 무엇이며 자바 코드는 어떻게 실행하는가?
### 학습 목표(필수)
- JVM이란 무엇인가?
- 컴파일 하는 방법
- 실행하는 방법
- 바이트코드란 무엇인가?
- JIT 컴파일러란 무엇이며 어떻게 동작하는지
- JVM 구성 요소
- JDK와 JRE의 차이
___
___
#### 1. JVM이란 무엇인가
**JVM**은 **J**ava **V**irtual **M**achine의 약자로서, 컴퓨터에서 자바 바이트코드로 작성된 파일(*.class)을 실행할 수 있게 해주는 가상 머신입니다. 자바로 작성된 프로그램은 모두 이 JVM 위에서만 동작할 수 있기 때문에, 자바 프로그램을 실행시키기 위해서는 **반드시** JVM이 필요합니다.

<img width="180" alt="스크린샷 2021-08-31 오후 10 47 25" src="https://user-images.githubusercontent.com/80696862/131514057-21c6bd7c-c20a-4b8c-8b8b-34a1502e9ef6.png">

위 그림처럼 자바 프로그램은 JVM 위에서만 동작할 수 있습니다.
___
#### 2. 자바 파일을 실행시키는 방법
자바 프로그램을 개발하는 순서는 아래와 같습니다.
1. 자바 파일 작성
2. 작성된 자바 파일을 컴파일
3. 자바 실행 파일을 실행


각 단계를 좀 더 상세히 알아봅시다.

##### 2-1. 자바 파일 작성
먼저, Hello.java라는 파일을 만들고 아래처럼 자바 문법에 맞게 코드를 작성해봅니다.

```java
public class Hello {
    public static void main(String[] args) {
        System.out.println("Hello~");
    }
}
```
<img width="655" alt="스크린샷 2021-08-31 오후 7 53 45" src="https://user-images.githubusercontent.com/80696862/131497197-b6a8f9a2-1780-44d1-b16b-66d6fdd6b8cd.png">
파일을 만든 후, 해당 파일이 위치하는 디렉토리를 확인해보면 Hello.java 파일이 생겨있습니다.
이 파일을 소스 파일이라고 합니다. (Hello.java)

##### 2-2. 컴파일
자바와 같은 사람만이 해석할 수 있는 언어를 **고급 언어**라고 하고,
숫자 1과 0으로만 이루어진 컴퓨터가 해석할 수 있는 언어를 **저급 언어**라고 합니다.
따라서 자바 파일을 실행하기 위해선 저급 언어로 변환하는 과정이 필요하고 이를 **컴파일**이라고 합니다.
그리고 컴파일을 하는 프로그램을 **컴파일러**라고 합니다.
자바 컴파일러는 JDK를 설치하면 javac.exe라는 실행 파일 형태로 설치됩니다.

자바 파일을 컴파일 하는 명령어는 아래와 같습니다.
>**javac Hello.java**

이후 다시 디렉토리를 확인해보면 Hello.class라는 파일이 생겨있습니다.
<img width="658" alt="스크린샷 2021-08-31 오후 8 49 13" src="https://user-images.githubusercontent.com/80696862/131497345-bb984585-705a-443b-805d-1cd6faef5cdf.png">

##### 2-3. 자바 파일 실행
그리고 이 클래스 파일을 실행하기 위해 아래의 명령어를 입력합니다.
>**java Hello**

<img width="660" alt="스크린샷 2021-08-31 오후 8 51 17" src="https://user-images.githubusercontent.com/80696862/131497625-ccf0afdb-48e0-445d-8f94-e98a76ec71aa.png">

Hello~ 라고 정상적으로 실행되는 것을 볼 수 있습니다.
___
#### 3. 바이트 코드란 무엇인가?
바이트 코드는 JVM이 해석할 수 있는 언어로, 컴파일된 자바 클래스 파일을 의미합니다. JVM은 이 바이트 코드를 읽어서 컴퓨터가 이해할 수 있는 기계어로 변환합니다. 이 0과 1로만 이루어진 기계어를 바이너리 코드라고도 합니다.

바이트 코드를 확인하는 명령어는 아래와 같습니다.
>**javap -c Hello**

자바 실행 구조는 아래와 같습니다.

<img width="500" alt="스크린샷 2021-08-31 오후 9 01 03" src="https://user-images.githubusercontent.com/80696862/131498925-d4e77d79-546f-4167-98b2-b17bc4b38792.png">

JVM은 컴파일된 자바 파일(바이트 코드)을 해당 JVM이 설치된 운영체제에 맞는 바이너리 코드로 변환합니다. 이 말은 JVM만 설치되어 있다면 어느 운영체제에서든 자바 파일을 실행할 수 있다는 뜻입니다. 즉, 자바 언어는 플랫폼에 독립적이다라고 할 수 있습니다. 자바의 이런 특성을 가지고 "Write once, run anywhere" 한번 작성하면 어디에서든 동작한다라고 표현합니다.

그렇다면 JVM은 자바 언어만 사용할까요?
아닙니다. JVM 위에선 바이트 코드로 컴파일될 수 있는 모든 언어가 사용될 수 있습니다.
바이트 코드로 컴파일되는 언어는 자바 외에도 Kotlin, Scala, JRuby등이 있습니다.

___
#### 4. JIT 컴파일러란 무엇인가?
자바 프로그램을 실행하기 위해선 바이트 코드로 작성된 파일이 필요합니다. 하지만 바이트 코드는 기계어가 아니므로 컴퓨터에서 실행할 수 없습니다. 
___
#### 5. JVM의 구성요소
<img width="500" alt="스크린샷 2021-09-01 오후 10 42 29" src="https://user-images.githubusercontent.com/80696862/131682331-698ede61-2650-4d58-b52e-d74f444556ef.png">

JVM은 크게 클래스 로더, 메모리, 실행 엔진, JNI, 네이티브 메소드 라이브러리 부분 총 5개 부분으로 구분할 수 있습니다. 한 부분씩 알아보겠습니다.

##### 클래스 로더
자바 프로그램이 실행되면, 클래스 로더가 가장 먼저 동작합니다. 클래스 로더는 크게 3단계 순서로 동작합니다.
1. 실행에 필요한 모든 클래스 파일(*.class)를 **로딩**합니다.
2. 레퍼런스를 연결하는 **링킹**과정을 진행합니다.
3. static 값들을 **초기화**한 후 변수에 할당합니다.

자세한 클래스 로더 내용은 아래에서 더 다뤄보도록 하겠습니다.

##### 메모리
메모리 영역은 크게 5개 부분으로 나뉩니다. 
- 메소드 영역에는 클래스나 인터페이스 수준의 정보(클래스 명, 부모 클래스 명, 메소드 정보, 변수 정보)가 저장됩니다. 메소드 영역에 저장된 정보는 **공유 자원**이며, JVM이 시작될 때 생성됩니다.
- 힙 영역에는 실제 인스턴스들이 저장되며 역시 공유자원입니다.
- 네이티브 메소드 스택에는 C나 C++로 작성된 메소드의 정보가 저장되는 공간입니다.
- PC(PC registers)영역에는 스레드마다 스레드 내 현재 실행할 명령의 위치를 가리키는 포인터가 생성됩니다. 스레드가 시작될 때 생성되며 스레드마다 하나씩 갖고 있습니다.
- 메소드 호출 시 해당 메소드만을 위한 공간(스택 프레임)이 생성됩니다. 지역변수나 파라미터, 리턴값, 연산에 사용되는 임시 값 등이 저장되며 메소드가 종료되면 해당 스택 프레임이 삭제됩니다. 

##### 실행 엔진
실행 엔진은 인터프리터, JIT, GC 총 3가지 부분으로 나뉩니다.
- 인터프리터는 바이트 코드를 한줄씩 해석합니다.
- JIT 컴파일러는 반복되는 코드 부분을 바로(**J**ust **I**n **T**ime) 컴파일 해서 네이티브 코드로 바꿔둡니다. 이후 인터프리터는 반복되는 부분을 만나면 이 네이티브 코드를 바로 사용합니다.
- GC는 힙영역에서 더이상 참조되지 않는 객체를 정리하는 작업을 합니다.

##### 네이티브 메소드 인터페이스(JNI)
자바 애플리케이션에서 C나 C++로 작성된 메소드나 라이브러리를 사용할 수 있는 인터페이스를 제공하는 공간입니다.

##### 네이티브 메소드 라이브러리
C와 C++로 작성된 라이브러리 정보가 저장되어있는 공간입니다.

___
#### 6. JDK와 JRE의 차이는?
**JRE**는 **J**ava **R**untime **E**nvironment의 약자로 자바 실행 환경을 말합니다. 여기엔 JVM과 자바 라이브러리들이 포함되어있습니다. 개발하는 환경이 아닌 단지 자바를 실행만 하는 환경이라면, JRE만 설치하면 자바 파일을 실행할 수 있습니다.

**JDK**는 **J**ava **D**evelopment **K**it의 약자로 자바 개발 도구를 말합니다. JDK에는 위에서 설명한 JRE와 개발에 필요한 여러 도구들이 포함되어있습니다.
<img width="500" alt="스크린샷 2021-08-31 오후 9 31 35" src="https://user-images.githubusercontent.com/80696862/131502952-23925d5c-6b7d-4ba0-bb14-e45cebacf219.png">

\* 현재 **Java11** 버전부터는 오직 JDK만 제공하고 있습니다.

참고 : [더 자바, 코드를 조작하는 다양한 방법](https://www.inflearn.com/course/the-java-code-manipulation/dashboard), [처음 해보는 자바 프로그래밍](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=179702789)



